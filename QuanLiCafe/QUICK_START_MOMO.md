# ?? QUICK START - THANH TOÁN MOMO

## ?? CÁCH CH?Y DEMO NHANH NH?T

### **B??c 1: Ch?y ?ng d?ng**
```
F5 trong Visual Studio
ho?c
dotnet run --project QuanLiCafe/QuanLiCafe.csproj
```

### **B??c 2: ??ng nh?p**
```
Username: admin
Password: admin123
```

### **B??c 3: M? FormMoMoDemo**
- Tìm và click nút **"Thanh Toán v?i MOMO"** trong FormMain

### **B??c 4: Thêm s?n ph?m vào gi?**
```
1. Click "Cà Phê ?en" trong danh sách
2. Click nút "? THÊM VÀO GI?"
3. Click "Sinh T? B?"
4. ??i s? l??ng thành 2
5. Click "? THÊM VÀO GI?"
```

### **B??c 5: Thanh toán**
```
1. Xem t?ng ti?n trong panel "?? THANH TOÁN"
2. Click nút "?? THANH TOÁN QUA MOMO"
3. Dialog xác nh?n xu?t hi?n ? Click "Yes"
4. Trình duy?t t? ??ng m?
5. Trang MoMo hi?n th? QR code
```

### **B??c 6: Xem k?t qu?**
```
? Link thanh toán ?ã ???c t?o
? QR code hi?n th? trong trình duy?t
? Có th? quét b?ng app MoMo test
? Gi? hàng t? ??ng reset sau 2 giây
```

---

## ?? DEMO V?I S?N PH?M M?U

### **5 S?n Ph?m Demo:**
| STT | Tên S?n Ph?m | Giá |
|-----|--------------|-----|
| 1 | ? Cà Phê ?en | 25,000 ? |
| 2 | ? Cà Phê S?a | 30,000 ? |
| 3 | ?? Trà S?a Truy?n Th?ng | 35,000 ? |
| 4 | ?? Sinh T? B? | 40,000 ? |
| 5 | ?? Bánh Mì Tr?ng | 20,000 ? |

### **Ví D? Combo:**

**Combo 1 - Cà phê sáng (55,000 ?):**
- Cà Phê ?en x2
- Gi?m giá: 0%
- VAT: 10%
- **T?ng: 55,000 ?**

**Combo 2 - Trà chi?u (103,950 ?):**
- Cà Phê ?en x1
- Sinh T? B? x2
- Gi?m giá: 10%
- VAT: 10%
- **T?ng: 103,950 ?**

**Combo 3 - Ti?c nhóm (388,025 ?):**
- Cà Phê S?a x5
- Trà S?a x3
- Sinh T? B? x2
- Bánh Mì x4
- Gi?m giá: 15%
- VAT: 10%
- **T?ng: 388,025 ?**

---

## ?? TÍNH N?NG CHÍNH

### **1. FormMoMoDemo**
? Danh sách 5 s?n ph?m m?u  
? Thêm/xóa s?n ph?m vào gi?  
? ?i?u ch?nh s? l??ng  
? Tính gi?m giá & VAT t? ??ng  
? Thanh toán qua MoMo Sandbox  
? T? ??ng m? trình duy?t  
? Reset gi? hàng sau thanh toán  

### **2. Tích h?p FormOrder**
? Nút "?? THANH TOÁN MOMO"  
? Thanh toán cho ??n hàng th?c  
? C?p nh?t tr?ng thái bàn  
? L?u order vào database  

---

## ??? HÌNH ?NH (Mô T? Text)

### **FormMoMoDemo - Layout:**
```
????????????????????????????????????????????????????
?     ?? DEMO THANH TOÁN MOMO                     ?
????????????????????????????????????????????????????
? ??? S?N PH?M  ?      ?? GI? HÀNG                 ?
?              ?                                   ?
? [ListBox]    ?  [DataGridView]                  ?
? - Cà Phê     ?  Cà Phê ?en  2  25,000  50,000  ?
? - Trà S?a    ?  Sinh T? B?  1  40,000  40,000  ?
? - ...        ?                                   ?
?              ?  ??????????????????????????????  ?
? SL: [1]      ?  ?? THANH TOÁN                   ?
?              ?  Gi?m giá: [0] %                 ?
? ? THÊM      ?  VAT:      [10] %                ?
? ??? XÓA       ?                                   ?
? ?? RESET     ?  T?m tính:     90,000 ?          ?
?              ?  Gi?m giá:         0 ?          ?
?              ?  VAT:          +9,000 ?          ?
?              ?  ?????????????????????           ?
?              ?  T?NG C?NG: 99,000 ?             ?
?              ?                                   ?
?              ?  [?? THANH TOÁN QUA MOMO]        ?
????????????????????????????????????????????????????
```

### **Dialog Xác Nh?n:**
```
?????????????????????????????????
?  ?? XÁC NH?N THANH TOÁN MOMO ?
?????????????????????????????????
?                               ?
?  ?? S?n ph?m: 2 món          ?
?  ?????????????????????????  ?
?  • Cà Phê ?en x2             ?
?  • Sinh T? B? x1             ?
?  ?????????????????????????  ?
?                               ?
?  T?m tính:     90,000 ?      ?
?  Gi?m giá (0%):     0 ?      ?
?  VAT (10%):    +9,000 ?      ?
?  ??????????????????????       ?
?  ?? T?NG C?NG: 99,000 ?      ?
?                               ?
?  Xác nh?n thanh toán MoMo?   ?
?                               ?
?      [Yes]        [No]        ?
?????????????????????????????????
```

### **MoMo Payment Page:**
```
???????????????????????????????
?        MOMO SANDBOX         ?
???????????????????????????????
?                             ?
?     ???????????????????     ?
?     ?                 ?     ?
?     ?   [QR CODE]     ?     ?
?     ?                 ?     ?
?     ???????????????????     ?
?                             ?
?  Thông tin ??n hàng:        ?
?  • S? ti?n: 99,000 ?       ?
?  • N?i dung: Demo Cafe...  ?
?                             ?
?  ?? Quét mã ?? thanh toán  ?
?                             ?
???????????????????????????????
```

---

## ?? TROUBLESHOOTING

### **L?i: Không m? ???c trình duy?t**
**Nguyên nhân:** UseShellExecute = false  
**Gi?i pháp:** Code ?ã set = true, n?u v?n l?i th?:
```csharp
System.Diagnostics.Process.Start("cmd", $"/c start {payUrl}");
```

### **L?i: MoMo API tr? v? resultCode != 0**
**Ki?m tra:**
- [ ] Internet connection OK?
- [ ] Signature tính ?úng?
- [ ] Amount > 0?
- [ ] OrderInfo không quá dài?

### **L?i: Build failed**
```bash
# Restore packages
dotnet restore

# Rebuild
dotnet clean
dotnet build
```

### **L?i: Form không m?**
**Ki?m tra:**
- Button "Thanh Toán v?i MOMO" ?ã ???c t?o trong Designer?
- Event handler `button1_Click` ?ã k?t n?i?

---

## ?? TEST V?I APP MOMO

### **T?i App MoMo Test:**
1. Truy c?p: https://developers.momo.vn/docs/sdk/test-app/
2. T?i app test cho Android/iOS
3. Cài ??t app

### **Quét QR Code:**
1. M? app MoMo test
2. Click "Quét mã"
3. H??ng camera vào QR code trên màn hình
4. Xác nh?n thanh toán

### **K?t qu?:**
```
? Giao d?ch thành công (test mode)
? Không tr? ti?n th?t
? Nh?n thông báo k?t qu?
```

---

## ?? LOGS M?U

### **Console Output (Successful):**
```
[INFO] FormMoMoDemo opened
[INFO] Added: Cà Phê ?en x2
[INFO] Added: Sinh T? B? x1
[INFO] Calculating total...
[INFO] SubTotal: 90,000
[INFO] Discount (0%): 0
[INFO] VAT (10%): 9,000
[INFO] Total: 99,000
[INFO] Creating MoMo payment URL...
[INFO] Signature created: a7b3c9d8...
[INFO] Sending request to MoMo API...
[INFO] Response received: {"resultCode":0,...}
[INFO] PayUrl: https://test-payment.momo.vn/...
[INFO] Opening browser...
[SUCCESS] MoMo payment created successfully!
```

### **MoMo API Response:**
```json
{
  "partnerCode": "MOMO",
  "orderId": "638734812345678900",
  "requestId": "638734812345678900",
  "amount": 99000,
  "responseTime": 1699999999999,
  "message": "Success",
  "resultCode": 0,
  "payUrl": "https://test-payment.momo.vn/gw_payment/qr/...",
  "deeplink": "momo://app...",
  "qrCodeUrl": "https://test-payment.momo.vn/qr/..."
}
```

---

## ?? K?CH B?N DEMO CHO VIDEO

### **Th?i l??ng:** 3 phút

**[0:00-0:30] Gi?i thi?u**
- Chào m?ng ??n v?i demo thanh toán MoMo
- H? th?ng qu?n lý quán cà phê
- Tích h?p MoMo Sandbox API

**[0:30-1:00] M? Form Demo**
- Click nút "Thanh Toán v?i MOMO"
- FormMoMoDemo hi?n th?
- Gi?i thi?u giao di?n: 5 s?n ph?m bên trái, gi? hàng bên ph?i

**[1:00-1:30] Thêm s?n ph?m**
- Click "Cà Phê ?en" ? Click "Thêm vào gi?"
- Ch?n "Sinh T? B?", ??i s? l??ng = 2 ? Thêm
- Gi? hàng hi?n th? 2 món

**[1:30-2:00] ?i?u ch?nh**
- Nh?p gi?m giá: 10%
- VAT gi? nguyên: 10%
- T?ng ti?n t? ??ng c?p nh?t

**[2:00-2:30] Thanh toán**
- Click "THANH TOÁN QUA MOMO"
- Dialog xác nh?n hi?n ra
- Click "Yes"
- Trình duy?t t? m?

**[2:30-3:00] K?t qu?**
- Trang MoMo hi?n th? QR code
- S? ti?n: 103,950 ?
- Demo hoàn t?t!

---

## ?? H?C T? CODE

### **1. Async/Await Pattern:**
```csharp
private async void BtnPayWithMoMo_Click(object? sender, EventArgs e)
{
    string payUrl = await _momoService.CreatePaymentUrl(total, orderInfo);
    // UI không b? block
}
```

### **2. HMAC-SHA256 Signature:**
```csharp
using (var hmac = new HMACSHA256(Encoding.UTF8.GetBytes(secretKey)))
{
    byte[] hash = hmac.ComputeHash(Encoding.UTF8.GetBytes(rawText));
    return BitConverter.ToString(hash).Replace("-", "").ToLower();
}
```

### **3. JSON Serialization:**
```csharp
var requestBody = new { partnerCode, amount, ... };
string json = JsonConvert.SerializeObject(requestBody);
var content = new StringContent(json, Encoding.UTF8, "application/json");
```

### **4. HTTP POST Request:**
```csharp
using (var httpClient = new HttpClient())
{
    var response = await httpClient.PostAsync(endpoint, content);
    string responseString = await response.Content.ReadAsStringAsync();
    dynamic jsonResponse = JsonConvert.DeserializeObject(responseString);
}
```

---

## ? CHECKLIST DEMO

- [ ] ?ng d?ng ch?y thành công (F5)
- [ ] ??ng nh?p ???c (admin/admin123)
- [ ] Nút "Thanh Toán v?i MOMO" hi?n th?
- [ ] FormMoMoDemo m? ???c
- [ ] 5 s?n ph?m hi?n th? ?úng
- [ ] Thêm vào gi? ho?t ??ng
- [ ] Tính t?ng ti?n ?úng
- [ ] Nút thanh toán MoMo ho?t ??ng
- [ ] Trình duy?t t? m?
- [ ] QR code hi?n th?
- [ ] Gi? hàng reset sau thanh toán

---

## ?? K?T QU?

**DEMO THÀNH CÔNG!** ??

? Tích h?p MoMo Payment API  
? Form demo v?i 5 s?n ph?m m?u  
? Tính toán gi?m giá & VAT  
? T?o link thanh toán  
? QR code t? ??ng  
? Build successful  

**S?n sàng trình di?n!** ??

---

**Created:** 2024  
**Version:** 1.0  
**Status:** ? READY
